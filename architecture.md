
## **智能投顾系统（Smart Investment Advisor）项目需求文档 (PRD)**

### **1. 项目概述 (Project Overview)**

#### **1.1. 项目愿景 (Vision)**
构建一个数据驱动、AI赋能的下一代智能投顾平台。该平台旨在为基金公司及其客户提供高度个性化、动态、透明且合规的投资决策支持服务，致力于在严格的风险控制下，追求可持续的超额回报（Alpha），并建立长期的客户信任。

#### **1.2. 核心目标 (Core Objectives)**
*   **深度个性化 (Hyper-Personalization):** 超越传统的风险标签，结合客户的行为金融学特征、生命周期阶段和财务目标，提供千人千面的投资方案。
*   **全景市场洞察 (Holistic Market Insight):** 整合传统金融数据与另类数据（Alternative Data），利用AI实现对市场宏观、中观（行业）、微观（个股）的穿透式分析和预判。
*   **全流程风险管理 (End-to-End Risk Management):** 将风险管理嵌入投前、投中、投后全流程，实现从风险预算、敞口监控到压力测试的闭环管理。
*   **内嵌式合规 (Compliance by Design):** 将合规性作为系统设计的基石，确保所有数据处理、模型推荐和交易建议都自动符合最新的法律法规要求。
*   **可解释性与信任 (Explainability & Trust):** 确保AI的“黑箱”对投资顾问和最终客户是透明、可解释的，让每一个决策都有据可循。

### **2. 核心技术栈 (Technology Stack)**

*   **数据采集与处理:**
    *   **结构化数据:** Python (Pandas, NumPy, **Dask** 用于处理无法载入内存的大型数据集)。
    *   **非结构化数据:** NLP (**FinBERT** 针对金融领域预训练模型，效果优于通用BERT, SpaCy)、Web Scraping (Scrapy)。
    *   **API集成:** Wind (万得), Choice (东方财富), Tushare Pro, CUBE (Qwen, 阿里通义千问), **Refinitiv (路透), Bloomberg API** (覆盖更广的全球市场和宏观数据)。
*   **AI建模:**
    *   **机器学习:** XGBoost, LightGBM, **CatBoost** (对类别特征处理更友好)。
    *   **深度学习:** LSTM, GRU, **Transformer** (在时间序列预测中，注意力机制能捕捉更长期的依赖关系)。
    *   **强化学习:** Ray (RLlib), **Stable Baselines3** (更成熟易用的强化学习库)。
    *   **可解释性AI (XAI):** **SHAP, LIME** (用于解释模型预测结果，是建立信任的关键)。
*   **系统架构:**
    *   **前端:** React/Vue.js。
    *   **后端:** **FastAPI** (基于Python 3.7+的现代高性能Web框架，性能优于Flask/Django，自带文档)。
    *   **数据库:**
        *   **关系型:** **PostgreSQL** (功能比MySQL更强大，特别是在GIS和复杂查询方面)。
        *   **时序数据库:** **TimescaleDB** 或 **InfluxDB** (用于存储和高效查询高频行情数据)。
        *   **缓存:** Redis。
    *   **云平台:** AWS/Azure/阿里云 (提供完整的Serverless, Kubernetes集群和MLOps解决方案)。
    *   **MLOps & DevOps:** **Docker, Kubernetes, MLflow/Kubeflow** (用于模型版本管理、实验追踪、自动化部署)。

### **3. 模块化设计 (Modular Design)**

#### **模块一：用户画像与风险测评 (User Profiling & Risk Assessment)**

*   **功能增强:**
    1.  **多维动态画像:** 除了静态问卷，增加**行为数据分析**。通过分析用户在APP内的浏览、搜索、交易行为，结合**行为金融学**（如损失厌恶、处置效应）理论，动态修正用户的真实风险偏好。
    2.  **目标导向的财务规划 (Goal-Based Planning):** 用户可设定多个财务目标（如退休、购房、子女教育），系统为每个目标独立规划投资路径和资金需求。
    3.  **客户统一视图 (Customer 360):** 整合客户的账户信息、行为数据、风险测评、通讯记录等，为投资顾问生成一份全面的客户视图报告。
*   **技术实现:**
    *   **模型:** 采用**混合模型**，决策树用于基础分类，**聚类算法 (K-Means)** 用于发现细分客群，**隐马尔可夫模型 (HMM)** 用于分析用户状态转移。
    *   **规则引擎:** 使用**Drools**或自研规则引擎，将KYC (了解你的客户) 和适当性匹配规则化、自动化。

#### **模块二：市场数据中台 (Market Data Hub)**

*   **功能增强:**
    1.  **另类数据集成 (Alternative Data Integration):** 除了传统数据，重点整合**卫星图像数据** (如停车场车辆密度判断商场景气度)、**供应链数据**、**招聘数据**、**舆情数据** (社交媒体、新闻)，构建独特的信息优势。
    2.  **统一特征工程平台 (Feature Store):** 建立一个集中管理、可复用的金融特征库 (Alpha Factors)。特征应包含版本控制、血缘关系和元数据管理。
    3.  **知识图谱构建 (Knowledge Graph):** 利用NLP技术，从研报、公告、新闻中抽取实体（公司、人物、产品）和关系（投资、竞争、合作），构建金融知识图谱，用于事件驱动分析和深层逻辑挖掘。
*   **技术实现:**
    *   **数据采集:** **Apache Pulsar** (相比Kafka，提供更灵活的订阅模型和分层存储)。
    *   **数据湖/仓:** 在对象存储 (S3/OSS) 上使用 **Delta Lake** 或 **Hudi** 构建数据湖，并结合 **ClickHouse** 或 **Snowflake** 进行高性能分析查询。
    *   **ETL/ELT:** 使用 **Apache Flink** 进行实时流处理和事件驱动计算，**dbt (Data Build Tool)** 管理数据转换逻辑。

#### **模块三：AI投资策略引擎 (AI Investment Strategy Engine)**

*   **功能增强:**
    1.  **宏观择时模型:** 基于经济周期（复苏、过热、滞胀、衰退）和市场情绪指标，利用**Transformer模型**给出大类资产（股、债、商品、现金）的超配/低配信号。
    2.  **行业轮动模型:** 结合中观行业数据（景气度、估值、资金流向）和产业链图谱，利用图神经网络（GNN）或梯度提升树模型预测未来高景气的行业。
    3.  **多因子模型PLUS:**
        *   **因子挖掘:** 利用AI算法（如遗传算法）从海量数据中自动挖掘新的有效因子 (Alpha)。
        *   **动态因子权重:** 使用**强化学习**或**元学习 (Meta-Learning)** 根据市场状态动态调整不同因子的权重，而非静态加权。
    4.  **可解释的资产配置:** 在 Black-Litterman 模型基础上，融入AI预测的市场观点，并使用**SHAP**等工具向投顾解释AI观点对最终权重调整的贡献。
*   **技术实现:**
    *   **回测框架:** **Zipline** 或 **Backtrader**，并进行二次开发以支持更复杂的策略和绩效归因（如Brinson归因）。
    *   **模型管理:** **MLflow** 全面介入，追踪实验、打包模型、注册模型版本并管理其生命周期。

#### **模块四：风险控制与合规监控 (Risk Management & Compliance Monitoring)**

*   **功能增强:**
    1.  **全方位风险指标:** 除了夏普比率和最大回撤，增加**索提诺比率 (Sortino Ratio)** (衡量下行风险)、**在险价值 (VaR)** 和 **条件在险价值 (CVaR)**。
    2.  **实时敞口监控:** 实时计算并监控组合在**风格因子**（如价值、成长）、**行业、市值、地缘政治**等维度的风险敞口。
    3.  **情景分析与反向压力测试:** 除了模拟历史事件，支持**自定义情景分析**（如“若中美利率倒挂加剧”）。**反向压力测试**则回答“需要发生什么情况，才会让我的组合亏损30%？”。
    4.  **合规规则引擎化:** 将所有监管条例和公司风控规则代码化、参数化，存入数据库，实现新规上线时的快速配置和全系统生效。
*   **技术实现:**
    *   **计算引擎:** Pandas, NumPy，并引入 **QuantLib** 库进行专业的金融工具定价和风险计算。
    *   **API化:** 将风险计算和合规检查封装成独立的微服务，供系统各处调用。

#### **模块五：用户交互与可视化 (UI/UX & Visualization)**

*   **功能增强:**
    1.  **双端设计 (投顾端 vs 客户端):**
        *   **投顾工作台:** 强大、专业。提供客户360视图、一键生成定制化投资建议书、批量调仓、合规预审等功能。
        *   **客户门户:** 简洁、易懂。用可视化的方式展示“我的资产”、“为何这样投”、“风险在哪里”，并提供投资学习内容。
    2.  **交互式报告与模拟:**
        *   **“What-If”分析:** 允许客户或投顾在前端调整部分参数（如“增加月定投金额”、“推迟退休年龄”），实时看到对未来财务规划的影响。
        *   **AI决策翻译器:** 利用XAI的结果，将复杂的模型决策（如“XGBoost认为因子A很重要”）翻译成人类可理解的语言（如“由于该公司近期研发投入显著增加，模型调高了其评级”）。
*   **技术实现:**
    *   **可视化库:** **Plotly/Dash**, **ECharts** (提供丰富的商业图表类型)。
    *   **实时通信:** 使用 **WebSocket** 向前端推送实时行情、账户变动和风险预警。

### **4. 非功能性需求 (Non-Functional Requirements)**

*   **性能 (Performance):**
    *   **API响应:** 核心API（查询、生成建议）99%分位响应时间 < 500ms。
    *   **数据延迟:** 行情数据端到端延迟 < 1s；T+1数据处理须在次日开盘前完成。
*   **安全 (Security):**
    *   **数据安全:** 严格遵循《个人信息保护法》、《数据安全法》、《金融数据安全》等法规。用户敏感数据**加密存储**，访问需多重鉴权。
    *   **纵深防御:** 实施网络隔离(VPC)、WAF防火墙、API网关认证、代码安全审计等措施。
*   **扩展性与可维护性 (Scalability & Maintainability):**
    *   **微服务架构:** 核心模块（用户、数据、策略、风控、交易）彻底解耦，独立部署。
    *   **基础设施即代码 (IaC):** 使用 **Terraform** 或 **Pulumi** 管理云资源，确保环境的一致性和可重复性。